// Generated by CoffeeScript 1.6.2
(function() {
  var Geoip,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  Geoip = (function() {
    function Geoip(handler, url) {
      var protocol;

      this.handler = handler;
      this.url = url != null ? url : "";
      this.callback = __bind(this.callback, this);
      if (!this.url) {
        protocol = global.location.protocol;
        this.url = "" + protocol + "//ru.smart-ip.net/geoip-json?lang=ru";
      }
      $.ajax({
        url: this.url,
        dataType: "jsonp",
        success: this.callback
      });
    }

    Geoip.prototype.callback = function(data) {
      console.log(data);
      this.country = data.countryName;
      this.city = data.city;
      return this.handler({
        country: this.country,
        city: this.city
      });
    };

    return Geoip;

  })();

  module.exports = Geoip;

}).call(this);
